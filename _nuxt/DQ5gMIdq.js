const y=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function h(r,n){n?n={...y,...n}:n=y;const s=m(n);return s.dispatch(r),s.toString()}const x=Object.freeze(["prototype","__proto__","constructor"]);function m(r){let n="",s=new Map;const e=t=>{n+=t};return{toString(){return n},getContext(){return s},dispatch(t){return r.replacer&&(t=r.replacer(t)),this[t===null?"null":typeof t](t)},object(t){if(t&&typeof t.toJSON=="function")return this.object(t.toJSON());const i=Object.prototype.toString.call(t);let a="";const c=i.length;c<10?a="unknown:["+i+"]":a=i.slice(8,c-1),a=a.toLowerCase();let u=null;if((u=s.get(t))===void 0)s.set(t,s.size);else return this.dispatch("[CIRCULAR:"+u+"]");if(typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(t))return e("buffer:"),e(t.toString("utf8"));if(a!=="object"&&a!=="function"&&a!=="asyncfunction")this[a]?this[a](t):r.ignoreUnknown||this.unkown(t,a);else{let o=Object.keys(t);r.unorderedObjects&&(o=o.sort());let f=[];r.respectType!==!1&&!g(t)&&(f=x),r.excludeKeys&&(o=o.filter(l=>!r.excludeKeys(l)),f=f.filter(l=>!r.excludeKeys(l))),e("object:"+(o.length+f.length)+":");const p=l=>{this.dispatch(l),e(":"),r.excludeValues||this.dispatch(t[l]),e(",")};for(const l of o)p(l);for(const l of f)p(l)}},array(t,i){if(i=i===void 0?r.unorderedArrays!==!1:i,e("array:"+t.length+":"),!i||t.length<=1){for(const u of t)this.dispatch(u);return}const a=new Map,c=t.map(u=>{const o=m(r);o.dispatch(u);for(const[f,p]of o.getContext())a.set(f,p);return o.toString()});return s=a,c.sort(),this.array(c,!1)},date(t){return e("date:"+t.toJSON())},symbol(t){return e("symbol:"+t.toString())},unkown(t,i){if(e(i),!!t&&(e(":"),t&&typeof t.entries=="function"))return this.array(Array.from(t.entries()),!0)},error(t){return e("error:"+t.toString())},boolean(t){return e("bool:"+t)},string(t){e("string:"+t.length+":"),e(t)},function(t){e("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),r.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(t.name)),r.respectFunctionProperties&&this.object(t)},number(t){return e("number:"+t)},xml(t){return e("xml:"+t.toString())},null(){return e("Null")},undefined(){return e("Undefined")},regexp(t){return e("regex:"+t.toString())},uint8array(t){return e("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},uint8clampedarray(t){return e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},int8array(t){return e("int8array:"),this.dispatch(Array.prototype.slice.call(t))},uint16array(t){return e("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},int16array(t){return e("int16array:"),this.dispatch(Array.prototype.slice.call(t))},uint32array(t){return e("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},int32array(t){return e("int32array:"),this.dispatch(Array.prototype.slice.call(t))},float32array(t){return e("float32array:"),this.dispatch(Array.prototype.slice.call(t))},float64array(t){return e("float64array:"),this.dispatch(Array.prototype.slice.call(t))},arraybuffer(t){return e("arraybuffer:"),this.dispatch(new Uint8Array(t))},url(t){return e("url:"+t.toString())},map(t){e("map:");const i=[...t];return this.array(i,r.unorderedSets!==!1)},set(t){e("set:");const i=[...t];return this.array(i,r.unorderedSets!==!1)},file(t){return e("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},blob(){if(r.ignoreUnknown)return e("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return e("domwindow")},bigint(t){return e("bigint:"+t.toString())},process(){return e("process")},timer(){return e("timer")},pipe(){return e("pipe")},tcp(){return e("tcp")},udp(){return e("udp")},tty(){return e("tty")},statwatcher(){return e("statwatcher")},securecontext(){return e("securecontext")},connection(){return e("connection")},zlib(){return e("zlib")},context(){return e("context")},nodescript(){return e("nodescript")},httpparser(){return e("httpparser")},dataview(){return e("dataview")},signal(){return e("signal")},fsevent(){return e("fsevent")},tlswrap(){return e("tlswrap")}}}const b="[native code] }",O=b.length;function g(r){return typeof r!="function"?!1:Function.prototype.toString.call(r).slice(-O)===b}function A(r,n,s={}){return r===n||h(r,s)===h(n,s)}function $(r,n,s={}){const e=d(r,s),t=d(n,s);return k(e,t,s)}function k(r,n,s={}){var i,a;const e=[],t=new Set([...Object.keys(r.props||{}),...Object.keys(n.props||{})]);if(r.props&&n.props)for(const c of t){const u=r.props[c],o=n.props[c];u&&o?e.push(...k((i=r.props)==null?void 0:i[c],(a=n.props)==null?void 0:a[c],s)):(u||o)&&e.push(new w((o||u).key,u?"removed":"added",o,u))}return t.size===0&&r.hash!==n.hash&&e.push(new w((n||r).key,"changed",n,r)),e}function d(r,n,s=""){if(r&&typeof r!="object")return new S(s,r,h(r,n));const e={},t=[];for(const i in r)e[i]=d(r[i],n,s?`${s}.${i}`:i),t.push(e[i].hash);return new S(s,r,`{${t.join(":")}}`,e)}class w{constructor(n,s,e,t){this.key=n,this.type=s,this.newValue=e,this.oldValue=t}toString(){return this.toJSON()}toJSON(){var n;switch(this.type){case"added":return`Added   \`${this.key}\``;case"removed":return`Removed \`${this.key}\``;case"changed":return`Changed \`${this.key}\` from \`${((n=this.oldValue)==null?void 0:n.toString())||"-"}\` to \`${this.newValue.toString()}\``}}}class S{constructor(n,s,e,t){this.key=n,this.value=s,this.hash=e,this.props=t}toString(){return this.props?`{${Object.keys(this.props).join(",")}}`:JSON.stringify(this.value)}toJSON(){const n=this.key||".";return this.props?`${n}({${Object.keys(this.props).join(",")}})`:`${n}(${this.value})`}}export{$ as d,A as i};
